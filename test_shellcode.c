#include <stdio.h> 
#include <windows.h> 
//char shellcode[] =        
//	"\x68\x6f\x20\x20\x00\x68\x4e\x68" 
//	"\x69\x44\x89\xe3\x68\x6f\x20\x20"
//	"\x00\x68\x4e\x68\x69\x44\x68\x20" 
//	"\x20\x20\x00\x68\x68\x69\x44\x6f" 
//	"\x68\x62\x79\x20\x4e\x68\x6e\x65" 
//	"\x64\x20\x68\x6e\x20\x70\x77\x68" 
//	"\x20\x62\x65\x65\x68\x68\x61\x76" 
//	"\x65\x68\x59\x6f\x75\x20\x89\xe1" 
//	"\x31\xc0\x50\x53\x51\x50\x50\xbe" 
//	"\xea\x07\x45\x7e\xff\xe6\x31\xc0" 
//	"\x50\xb8\x12\xcb\x81\x7c\xff\xe0";
	
char shellcode[] = 
	//open MessageBoxA of user 32
	//"\x31\xc0\x50\x68\x2e\x64\x6c\x6c\x68\x65\x72\x33\x32\x68\x34\x5c\x75\x73\x68\x57\x4f\x57\x36\x68\x5c\x53\x79\x73\x68\x64\x6f\x77\x73\x68\x5c\x57\x69\x6e\x68\x90\x90\x43\x3a\x89\xe6\x46\x46\x56\xbe\x30\x0f\x77\x76\xff\xd6\x31\xc0\x50\x68\x31\x32\x33\x34\x68\x61\x62\x63\x64\x89\xe3\x31\xc0\x50\x53\x53\x50\xbe\x40\xae\x9b\x77\xff\xd6";
	
	//open Notepad.exe		"C:\\Windows\\System32\\notepad.exe"
	//"\x55\x89\xe5\x83\xec\x24\x31\xd2\x52\x68\x2e\x65\x78\x65\x68\x65\x70\x61\x64\x68\x5c\x6e\x6f\x74\x68\x65\x6d\x33\x32\x68\x53\x79\x73\x74\x68\x6f\x77\x73\x5c\x68\x57\x69\x6e\x64\x68\x90\x43\x3a\x5c\x89\xe6\x46\xb8\xb0\x51\x5b\x75\x6a\x0a\x56\xff\xd0\xc9\xc3";
	//"\x31\xd2\x52\x68\x2e\x65\x78\x65\x68\x65\x70\x61\x64\x68\x5c\x6e\x6f\x74\x68\x65\x6d\x33\x32\x68\x53\x79\x73\x74\x68\x6f\x77\x73\x5c\x68\x57\x69\x6e\x64\x68\x90\x43\x3a\x5c\x89\xe6\x46\xb8\xb0\x51\x7a\x76\x6a\x0a\x56\xff\xd0";
	"\x55\x89\xe5\x83\xec\x18\x31\xf6\x56\x68\x78\x65\x63\x00\x68\x57\x69\x6e\x45\x89\x65\xfc\x64\x8b\x1d\x30\x00\x00\x00\x8b\x5b\x0c\x8b\x5b\x14\x8b\x1b\x8b\x1b\x8b\x5b\x10\x89\x5d\xf8\x8b\x43\x3c\x01\xd8\x8b\x40\x78\x01\xd8\x8b\x48\x24\x01\xd9\x89\x4d\xf4\x8b\x78\x20\x01\xdf\x89\x7d\xf0\x8b\x50\x1c\x01\xda\x89\x55\xec\x8b\x50\x14\x31\xc0\x8b\x7d\xf0\x8b\x75\xfc\x31\xc9\xfc\x8b\x3c\x87\x01\xdf\x66\x83\xc1\x08\xf3\xa6\x74\x0a\x40\x39\xd0\x72\xe5\x83\xc4\x26\xeb\x3c\x8b\x4d\xf4\x8b\x55\xec\x66\x8b\x04\x41\x8b\x04\x82\x01\xd8\x31\xd2\x52\x68\x2e\x65\x78\x65\x68\x63\x61\x6c\x63\x68\x6d\x33\x32\x5c\x68\x79\x73\x74\x65\x68\x77\x73\x5c\x53\x68\x69\x6e\x64\x6f\x68\x43\x3a\x5c\x57\x89\xe6\x6a\x0a\x56\xff\xd0\x83\xc4\x44\x5d\xc3";
	
	//open User32/DispatchMessageA
	//"\x31\xc0\x50\x68\x2e\x64\x6c\x6c\x68\x65\x72\x33\x32\x68\x34\x5c\x75\x73\x68\x57\x4f\x57\x36\x68\x5c\x53\x79\x73\x68\x64\x6f\x77\x73\x68\x5c\x57\x69\x6e\x68\x90\x90\x43\x3a\x89\xe6\x46\x46\x56\xbe\x30\x0f\x77\x76\xff\xd6\x31\xc0\x50\x68\x31\x32\x33\x34\x68\x61\x62\x63\x64\x89\xe3\x53\xbe\xe0\x7a\x9d\x77\xff\xd6";
	//"\x31\xc0\x50\x68\x31\x32\x33\x34\x68\x61\x62\x63\x64\x89\xe3\x31\xc0\x50\x53\x53\x50\xbe\x40\xae\x9b\x77\xff\xd6";
	//"x31\xd2\x52\x68\x2e\x65\x78\x65\x68\x63\x61\x6c\x63\x68\x6d\x33\x32\x5c\x68\x79\x73\x74\x65\x68\x77\x73\x5c\x53\x68\x69\x6e\x64\x6f\x68\x43\x3a\x5c\x57\x89\xe6\xb8\xb0\x51\x7a\x76\x6a\x0a\x56\xff\xd0";
int main() 
{ 
    //LoadLibrary("user32.dll"); 
    //LoadLibrary("kernel32.dll"); 
    
    void(*func)(); 
    func=(void(*)())shellcode; 
    (void)(*func)(); 
    
    printf("Ket thuc shellcode thanh cong");
    return 1;
}
